syntax = "proto3";

package divestore;

import "google/protobuf/timestamp.proto";
import "log.proto";
import "types.proto";

// A single dive log entry.
message Dive {
  string id = 1;
  Metadata meta = 2;
  string synced_etag = 3;

  int32 number = 4; // Dive number, human readable/assigned
  int32 rating = 5; // 0-5 stars
  repeated string tags = 6; // Free-form tag strings
  google.protobuf.Timestamp start = 7; // Unix epoch timestamp (seconds)

  // Summary data (populated from dive computer data, but editable by the user)
  int32 duration = 8; // Seconds
  double max_depth = 9; // Meters
  double mean_depth = 10; // Meters
  double min_temp = 11; // Celsius
  double max_temp = 12; // Celsius

  // Additional attributes
  double sac = 13; // l/min
  int32 otu = 14;
  int32 cns = 15; // Percentage

  // Link to dive site
  string site_id = 16;

  // Child elements
  string instructor = 17;
  string divemaster = 18;
  repeated string buddies = 19;
  string notes = 20;
  repeated DiveCylinder cylinders = 21;
  repeated Weightsystem weightsystems = 22;

  // Events like gas changed, initially extracted from dive computer data
  // but editable.
  repeated SampleEvent events = 24;

  // Start and end tissues for this dive, calculated
  Tissues start_tissues = 25;
  Tissues end_tissues = 26;
  reserved 27;
  double end_surf_gf = 28;

  // Raw dive computer data
  repeated Log deprecated_logs = 23;
  repeated Log logs = 64;
}

// Per-dive cylinder usage information.
message DiveCylinder {
  string cylinder_id = 1;
  double begin_pressure = 2; // Bar
  double end_pressure = 3; // Bar
  double oxygen = 4; // Fraction (0.0-1.0)
  double helium = 5; // Fraction (0.0-1.0)
  double used_volume = 6; // liters, calculated
  double sac = 7; // liters/min, calculated

  // Set when loaded, to full out volume etc.
  Cylinder cylinder = 8;
}

// Weight system information.
message Weightsystem {
  double weight = 1; // Kg
  string description = 2;
}
